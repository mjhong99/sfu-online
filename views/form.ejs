<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
    integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

  <link rel="stylesheet" href="https://bootswatch.com/4/darkly/bootstrap.min.css" />

  <link rel="stylesheet" href="/css/style2.css" type="text/css" />
</head>

<body>

  <a href="http://localhost:8000/users/channel_page/<%=name%>" > Back</a>


  <div>
      <h1>New message</h1>
      <div>
        <input id='sender' type="text" name="sender" class="form-control" placeholder="Name" required>
      </div>
      <div>
        <input id='message' type="text" name="message" class="form-control" placeholder="Enter a message" required>
      </div>
      <input id='msgCreate' type="submit" class="btn btn-primary btn-block" value="Submit">
  </div>


<div>

  <script>
    const btnCreate = document.getElementById("msgCreate")
    msgCreate.addEventListener("click", async e => {
      let jsonRequest = {}
      jsonRequest.sender = document.getElementById("sender").value
      jsonRequest.message = document.getElementById("message").value
      console.log("clientside:" + jsonRequest.sender);
      console.log("clientside:" + JSON.stringify(jsonRequest));
      let result = await fetch("http://localhost:8000/users/channel_page/<%=name%>", {
        method: "POST",
        headers: { "content-type": "application/json" }, body: JSON.stringify(jsonRequest)
      })
    })

    // redirects to channel_page
    document.getElementById("msgCreate").onclick = function () {
      location.assign("http://localhost:8000/users/channel_page/<%=name%>");
    }

  </script>

</div>


</body>
